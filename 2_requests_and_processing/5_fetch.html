<!--
ARTICLE ABOUT: https://developer.mozilla.org/ru/docs/Web/API/Fetch_API
HOW TO USE: https://developer.mozilla.org/ru/docs/Web/API/Fetch_API/Using_Fetch
RU ARTICLE: https://learn.javascript.ru/fetch
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fetch</title>
    <script>
        /*
        First example with Fetch to received the data
        let url = 'https://example.com/profile';
        let data = {username: 'example'};

        fetch(url, {
            method: 'POST', // or 'PUT'
            body: JSON.stringify(data), // data can be `string` or {object}!
            headers: {
                'Content-Type': 'application/json'
            } //make a request, received promise

        }).then(res => res.json()) //If promise executed successfully,
            we get a special response object (https://developer.mozilla.org/en-US/docs/Web/API/Response/Response)

            .then(response => console.log('Success:', JSON.stringify(response)))
            //The json() method returns a promise, so that we call the then again and in the callback we output the data to the console.

            .catch(error => console.error('Error:', error));*/

        /*Second example with Fetch to received and show picture*/
        let loadImage = function(url) {
            fetch(url)
                .then(response => {
                    if (response.status === 200) {
                        embedImage(url);
                    }
                })
                .catch(error => errorImage(error)
                );
        };

        const embedImage = function (url) {
            if(url){
                let image = document.getElementById("image");
                image.src = url;
                console.log(url);
            }
        };

        const errorImage = function (error) {
            document.getElementById("error").innerHTML = error.name + " " + error.message;
        }
    </script>
</head>
<body>
<!-- I left an incorrect link for the test
ERROR: TypeError Failed to fetch-->
<button onclick="loadImage('http://192.168.1.62:8080/im')">ERROR</button>

<button onclick="loadImage('https://avatars.mds.yandex.net/get-pdb/231404/b3e1a0ca-f922-44e0-8f0c-32560efeefae/orig')">ALL CORRECT</button>
<img id="image">
<div id="error"></div>

</body>
</html>